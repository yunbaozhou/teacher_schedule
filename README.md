# 教师课程表管理系统

## 项目简介

教师课程表管理系统是一个基于Web的课程表管理工具，允许教师和教务人员轻松创建、编辑、管理和导出课程表。该系统提供了直观的可视化界面，支持冲突检测、多种导出格式等功能，旨在简化课程表管理流程。

## 使用对象

- 学校教师：用于管理个人课程安排
- 教务管理人员：用于统筹全校课程安排
- 学生：查看课程时间安排
- 教学管理人员：进行课程规划和调整

## 技术栈

### 前端技术
- HTML5
- CSS3 (Tailwind CSS框架)
- JavaScript (ES6+)
- Font Awesome图标库
- html2canvas (用于图片导出功能)

### 后端技术
- Python 3.x
- Flask (Web框架)
- Pandas (数据处理)
- openpyxl (Excel文件处理)
- python-docx (Word文档处理)

### 数据存储
- 内存存储 (使用全局变量存储课程数据)

## 功能特性

### 1. 课程管理
- 添加新课程（支持设置课程名称、教师、时间、地点、备注等信息）
- 编辑现有课程
- 删除课程
- 可视化课程表展示

### 2. 颜色标识
- 自动为不同课程分配颜色
- 支持自定义课程颜色
- 预设颜色映射规则

### 3. 冲突检测
- 自动检测时间冲突
- 实时显示冲突信息

### 4. 数据导出
- 导出为Excel格式
- 导出为Word格式
- 导出为PNG图片格式
- 打印功能

### 5. 用户界面
- 响应式设计，支持多种设备
- 直观的可视化课程表
- 模态框操作界面
- 玻璃态效果设计

## 安装与运行

### 环境要求
- Python 3.6或更高版本
- pip包管理器

### 安装步骤

1. 克隆或下载项目代码
2. 安装依赖包：
   ```bash
   pip install pandas openpyxl python-docx flask
   ```

3. 运行应用：
   ```bash
   python schedule.py
   ```

4. 在浏览器中访问 `http://localhost:5000`

## 使用说明

1. 访问应用主页
2. 点击课程表中的单元格添加新课程
3. 在弹出的模态框中填写课程信息
4. 可以通过点击已有课程卡片来编辑或删除课程
5. 系统会自动检测时间冲突并在界面中提示
6. 可以通过顶部按钮导出课程表为不同格式

## 项目结构

```
teacher_schedule/
├── schedule.py          # 后端Flask应用
├── schedule.html        # 前端页面
├── README.md            # 项目说明文档
├── 课程表.xlsx          # Excel导出示例
└── 课程表.docx          # Word导出示例
```

## API接口

### 课程相关
- `GET /api/courses` - 获取所有课程
- `POST /api/courses` - 添加课程
- `POST /api/courses/conflicts` - 检查课程冲突

### 导出相关
- `POST /api/export/excel` - 导出为Excel
- `POST /api/export/word` - 导出为Word

## 注意事项

1. 课程数据存储在内存中，重启服务会丢失数据
2. 建议在生产环境中使用持久化存储方案
3. 确保安装了所有必需的依赖包

## 开发者信息

本项目使用Flask框架将Python脚本改造为Web服务，提供API接口，支持前端与后端交互。